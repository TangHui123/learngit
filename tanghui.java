tanghui java file

cherry pick two
